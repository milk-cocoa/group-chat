!function(){function t(t,i,e){var o=e.global,c=e.current_user;Vue.component("topics",{template:"#topics-template",data:{topics:[],new_topic:""},filters:{topics_filter:function(t){return t}},ready:function(){this.fetch()},methods:{fetch:function(){var t=this,e=i.dataStore("user").child(c.id).child("topics");e.on("push",function(i){t.topics.unshift({topic_id:i.value.topic_id,owner_id:i.value.owner_id,title:o.Util.escapeHTML(i.value.title)})}),e.query({}).asc().limit(20).done(function(i){i&&(t.topics=i.map(function(t){return{topic_id:t.topic_id,owner_id:t.owner_id,title:""==t.title?"トピック名が設定されていません":o.Util.escapeHTML(t.title)}}).reverse())})},create:function(){var t=i.dataStore("topics").child(c.id);this.new_topic&&(t.push({title:o.Util.escapeHTML(this.new_topic),user:c},function(t){var e=t.id,o=i.dataStore("topics").child(c.id).child(e).child("allow");o.set(c.email,{email:c.email});var n=i.dataStore("user").child(c.id).child("topics");n.push({topic_id:e,owner_id:c.id,title:t.value.title})}),this.new_topic="")},goto_chatroom:function(i,c){e.onSelectTopic(null,{id:i,owner_id:c,title:this.topics.filter(function(t){return t.topic_id==i})[0].title}),location.hash=o.Util.escapeHTML(c)+"/"+o.Util.escapeHTML(i),t.currentView="chat"}}})}window.init_topics=t}();