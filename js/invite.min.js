!function(){function i(i,t,e){var n=t.dataStore("email2user");Vue.component("invite",{template:"#invite-template",data:{topic_link:"",title:"",allow_users:[],invited_user_email:""},ready:function(){this.fetch()},methods:{fetch:function(){var i=this,n=e.current_topic.id,o=e.current_topic.owner_id,r=e.current_user.id;i.topic_link="#"+o+"/"+n;var c=t.dataStore("topics").child(o);c.get(n,function(t){i.title=t.title,window.document.title=i.title+" 設定"});var l=t.dataStore("topics").child(r).child(n).child("allow");l.query({}).done(function(t){i.allow_users=t.map(function(i){return{email:i.id}})}),l.off("set"),l.on("set",function(t){i.allow_users.push({email:t.id})})},invite:function(){var i=this,o=e.current_topic.id,r=e.current_user.id,c=t.dataStore("topics").child(r).child(o).child("allow");c.set(i.invited_user_email,{email:i.invited_user_email}),n.get(i.invited_user_email,function(e){var n=t.dataStore("user").child(e.user_id).child("topics");n.set(o,{topic_id:o,owner_id:r,title:i.title})})}}})}window.init_invite=i}();