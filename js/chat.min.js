!function(){function e(e,t,i){var n=i.global;return Vue.component("chat",{template:"#chat-template",data:{invite_link:"",title:"",messages:[],new_message:""},filters:{message_filter:function(e){return e}},ready:function(){this.fetch()},methods:{post:function(){if(this.new_message){var e=i.current_topic.id,s=i.current_topic.owner_id,c=t.dataStore("topics").child(s),a=c.child(e);a.push({content:n.Util.escapeHTML(this.new_message),user:i.current_user,timestamp:(new Date).getTime()}),this.new_message=""}},fetch:function(){var e=this,s=i.current_topic.id,c=i.current_topic.owner_id;e.invite_link="#"+c+"/"+s+"/invite";var a=t.dataStore("topics").child(c),o=a.child(s);a.get(s,function(t){e.title=t.title,window.document.title=e.title}),o.off("push"),o.on("push",function(t){e.messages.unshift({content:n.Util.escapeHTML(t.value.content),user:{name:n.Util.escapeHTML(t.value.user.name)}})}),o.query().sort("desc").limit(20).done(function(t){e.messages=t})}}})}window.init_chat=e}();